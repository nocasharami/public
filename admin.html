<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <style>
    body { font-family: Arial; padding:20px; }
    button { padding:4px 8px; margin-left:5px; }
    ul { list-style:none; padding:0; }
    li { margin:5px 0; }
  </style>
</head>
<body>
  <h1>Admin Panel</h1>
  <button onclick="createKey()">Create Key</button>
  <ul id="keysList"></ul>

  <script>
    const token = localStorage.getItem("token");

    function createKey() {
      fetch('/api/create-key', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': token
        }
      })
      .then(res => res.json())
      .then(data => {
        alert("New Key: " + data.key);
        listKeys();
      });
    }

    function banKey(key) {
      fetch('/api/ban-key', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'Authorization': token },
        body: JSON.stringify({ key })
      })
      .then(() => listKeys());
    }

    function unbanKey(key) {
      fetch('/api/unban-key', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'Authorization': token },
        body: JSON.stringify({ key })
      })
      .then(() => listKeys());
    }

    function listKeys() {
      fetch('/api/keys', { headers: { 'Authorization': token } })
      .then(res => res.json())
      .then(data => {
        const ul = document.getElementById('keysList');
        ul.innerHTML = "";
        data.forEach(k => {
          const li = document.createElement("li");
          li.innerHTML = `
            ${k.key} | Status: ${k.banned ? "Banned" : "Active"}
            <button onclick="banKey('${k.key}')">Ban</button>
            <button onclick="unbanKey('${k.key}')">Unban</button>
          `;
          ul.appendChild(li);
        });
      });
    }

    listKeys();
  </script>
</body>
</html>
